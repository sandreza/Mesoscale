<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Simulation 1 · Mesoscale</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Mesoscale</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Channels</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../channels_home/">Home</a></li><li class="is-active"><a class="tocitem" href>Simulation 1</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Boundary-Conditions-/-Source-Terms"><span>Boundary Conditions / Source Terms</span></a></li><li class="toplevel"><a class="tocitem" href="#Table-of-model-parameters-and-functional-form"><span>Table of model parameters and functional form</span></a></li><li class="toplevel"><a class="tocitem" href="#Comments-on-Parameter-Choices"><span>Comments on Parameter Choices</span></a></li><li class="toplevel"><a class="tocitem" href="#Initial-Condition"><span>Initial Condition</span></a></li></ul></li><li><a class="tocitem" href="../simulation_abernathy/">Abernathy Setup</a></li><li><a class="tocitem" href="../simulation_noflux/">No Flux Setup</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Channels</a></li><li class="is-active"><a href>Simulation 1</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Simulation 1</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sandreza/Mesoscale/blob/master/docs/src/simulation_1.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Mesoscale-Channel-Setup"><a class="docs-heading-anchor" href="#Mesoscale-Channel-Setup">Mesoscale Channel Setup</a><a id="Mesoscale-Channel-Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Mesoscale-Channel-Setup" title="Permalink"></a></h1><p>The equations of motion are <a href="../channels_home/#sec:eom">here</a>. The Oceananigans script is the hybrid.jl setup <a href="https://github.com/sandreza/Mesoscale/blob/master/oceananigans_scripts/hybrid.jl">here</a>.</p><h1 id="Boundary-Conditions-/-Source-Terms"><a class="docs-heading-anchor" href="#Boundary-Conditions-/-Source-Terms">Boundary Conditions / Source Terms</a><a id="Boundary-Conditions-/-Source-Terms-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-Conditions-/-Source-Terms" title="Permalink"></a></h1><ul><li>Buoyancy : Linear relaxation to the surface, insulating boundary conditions elsewhere. A sponge layer relaxation to the northern wall.</li><li>Momentum : Linear drag for the horizontal velocities, gaussian wind-stress for the zonal velocity at the surface, stress-free boundary conditions for the meridional velocity, no penetration for the wall normal velocities.</li></ul><h1 id="Table-of-model-parameters-and-functional-form"><a class="docs-heading-anchor" href="#Table-of-model-parameters-and-functional-form">Table of model parameters and functional form</a><a id="Table-of-model-parameters-and-functional-form-1"></a><a class="docs-heading-anchor-permalink" href="#Table-of-model-parameters-and-functional-form" title="Permalink"></a></h1><p>The default viscocity and diffusivity values for the simulation are</p><table><tr><th style="text-align: center">Parameter</th><th style="text-align: center">Value</th><th style="text-align: center">Units</th><th style="text-align: center">Description</th></tr><tr><td style="text-align: center"><span>$\kappa^h$</span></td><td style="text-align: center"><span>$0.5 \times 10^{-5}$</span></td><td style="text-align: center"><span>$\frac{\text{m}^2}{\text{s}}$</span></td><td style="text-align: center">horizontal diffusivity</td></tr><tr><td style="text-align: center"><span>$\kappa^v$</span></td><td style="text-align: center"><span>$0.5 \times 10^{-5}$</span></td><td style="text-align: center"><span>$\frac{\text{m}^2}{\text{s}}$</span></td><td style="text-align: center">vertical diffusivity</td></tr><tr><td style="text-align: center"><span>$\nu^h$</span></td><td style="text-align: center"><span>$12$</span></td><td style="text-align: center"><span>$\frac{\text{m}^2}{\text{s}}$</span></td><td style="text-align: center">horizontal viscocity</td></tr><tr><td style="text-align: center"><span>$\nu^v$</span></td><td style="text-align: center"><span>$3 \times 10^{-4}$</span></td><td style="text-align: center"><span>$\frac{\text{m}^2}{\text{s}}$</span></td><td style="text-align: center">vertical viscocity</td></tr></table><p>The physical parameter values are</p><table><tr><th style="text-align: center">Parameter</th><th style="text-align: center">Value</th><th style="text-align: center">Units</th><th style="text-align: center">Description</th></tr><tr><td style="text-align: center"><span>$\rho^0$</span></td><td style="text-align: center"><span>$1024$</span></td><td style="text-align: center"><span>$\frac{\text{kg}}{\text{m}^3}$</span></td><td style="text-align: center">reference density</td></tr><tr><td style="text-align: center"><span>$\alpha$</span></td><td style="text-align: center"><span>$2 \times 10^{-4}$</span></td><td style="text-align: center"><span>$\frac{1}{\text{K}}$</span></td><td style="text-align: center">thermal expansion coefficient</td></tr><tr><td style="text-align: center"><span>$g$</span></td><td style="text-align: center"><span>$9.8061$</span></td><td style="text-align: center"><span>$\frac{\text{m}}{\text{s}^2}$</span></td><td style="text-align: center">gravitational acceleration</td></tr></table><p>The domain is <span>$[0, L_x) \times [0, L_y] \times [-L_z, 0]$</span>, (periodic, wall-bounded, wall-bounded) with values</p><table><tr><th style="text-align: center">Parameter</th><th style="text-align: center">Value</th><th style="text-align: center">Units</th><th style="text-align: center">Description</th></tr><tr><td style="text-align: center"><span>$L_x$</span></td><td style="text-align: center"><span>$10^3$</span></td><td style="text-align: center"><span>$\text{km}$</span></td><td style="text-align: center">Zonal Length</td></tr><tr><td style="text-align: center"><span>$L_y$</span></td><td style="text-align: center"><span>$10^{3}$</span></td><td style="text-align: center"><span>$\text{km}$</span></td><td style="text-align: center">Meriodional Length</td></tr><tr><td style="text-align: center"><span>$L_z$</span></td><td style="text-align: center"><span>$3$</span></td><td style="text-align: center"><span>$\text{km}$</span></td><td style="text-align: center">Depth</td></tr></table><p>We use a <span>$\beta$</span>-plane coriolis </p><p class="math-container">\[\bm{f} = (f + \beta y)\hat{z}\]</p><p>with <span>$f$</span> and <span>$\beta$</span> values</p><table><tr><th style="text-align: center">Parameter</th><th style="text-align: center">Value</th><th style="text-align: center">Units</th><th style="text-align: center">Description</th></tr><tr><td style="text-align: center"><span>$f$</span></td><td style="text-align: center"><span>$-10^{-4}$</span></td><td style="text-align: center"><span>$\frac{1}{\text{s}}$</span></td><td style="text-align: center">constant term</td></tr><tr><td style="text-align: center"><span>$\beta$</span></td><td style="text-align: center"><span>$10^{-11}$</span></td><td style="text-align: center"><span>$\frac{1}{\text{m}} \frac{1}{\text{ s}}$</span></td><td style="text-align: center">linear term</td></tr></table><p>The sponge layer for buoyancy at northern wall is of the form</p><p class="math-container">\[\mathcal{S}^b(b,y,z) = - \frac{1}{\lambda^t}\left[ b - \Delta b  \frac{\exp \left( z/h \right) - \exp \left( -L_z/h \right)}{\exp \left( 0 \right) - \exp \left( -L_z/h \right)} \right] \exp \left( \frac{y - L_y}{\lambda^N} \right)\]</p><p>and the surface relaxation for buoyancy is</p><p class="math-container">\[\left. \Phi^*_b \right|_{\text{surface}} = \lambda^s \left(b - \Delta b \frac{y}{L_y} \right)\]</p><p>with parameter values</p><table><tr><th style="text-align: center">Parameter</th><th style="text-align: center">Value</th><th style="text-align: center">Units</th><th style="text-align: center">Description</th></tr><tr><td style="text-align: center"><span>$\lambda^s$</span></td><td style="text-align: center"><span>$10^{-4}$</span></td><td style="text-align: center"><span>$\frac{m}{\text{s}}$</span></td><td style="text-align: center">surface buoyancy velocity constant</td></tr><tr><td style="text-align: center"><span>$\Delta b$</span></td><td style="text-align: center"><span>$10 \times \alpha \times 10$</span></td><td style="text-align: center"><span>$\frac{\text{m}}{\text{ s}^2}$</span></td><td style="text-align: center">buoyancy jump</td></tr><tr><td style="text-align: center"><span>$h$</span></td><td style="text-align: center"><span>$1$</span></td><td style="text-align: center"><span>$\text{km}$</span></td><td style="text-align: center">northern wall stratification e-folding length</td></tr><tr><td style="text-align: center"><span>$\lambda^t$</span></td><td style="text-align: center"><span>$7 \times 86400$</span></td><td style="text-align: center"><span>$\text{s}$</span></td><td style="text-align: center">relaxation time</td></tr><tr><td style="text-align: center"><span>$\lambda^N$</span></td><td style="text-align: center"><span>$20$</span></td><td style="text-align: center"><span>$\text{km}$</span></td><td style="text-align: center">northern wall horizontal e-folding length</td></tr></table><p>The surface flux for the zonal velocity, (<span>$u$</span> where <span>$\bm{u} = (u,v,w)$</span>) is</p><p class="math-container">\[\left. \Phi^*_u \right|_{\text{surface}} = -\frac{\tau}{\rho_0} \left[ \exp \left( - \lambda^u \frac{(y-L_y/2)^2}{L_y^2} \right) - \exp \left( - \lambda^u \frac{(L_y/2)^2}{L_y^2} \right) \right]\]</p><p>with parameters</p><table><tr><th style="text-align: center">Parameter</th><th style="text-align: center">Value</th><th style="text-align: center">Units</th><th style="text-align: center">Description</th></tr><tr><td style="text-align: center"><span>$\tau$</span></td><td style="text-align: center"><span>$0.2$</span></td><td style="text-align: center"><span>$\frac{N}{\text{m}^2}$</span></td><td style="text-align: center">wind-stress magnitude</td></tr><tr><td style="text-align: center"><span>$\lambda^u$</span></td><td style="text-align: center"><span>$32$</span></td><td style="text-align: center">dimensionless</td><td style="text-align: center">decay constant</td></tr></table><p>The linear drag was chosen to be</p><table><tr><th style="text-align: center">Parameter</th><th style="text-align: center">Value</th><th style="text-align: center">Units</th><th style="text-align: center">Description</th></tr><tr><td style="text-align: center"><span>$\mu$</span></td><td style="text-align: center"><span>$10^{-3}$</span></td><td style="text-align: center"><span>$\frac{m}{\text{s}}$</span></td><td style="text-align: center">linear drag velocity parameter</td></tr></table><p>And finally the numerical parameters were</p><table><tr><th style="text-align: center">Parameter</th><th style="text-align: center">Value</th><th style="text-align: center">Units</th><th style="text-align: center">Description</th></tr><tr><td style="text-align: center"><span>$\Delta t$</span></td><td style="text-align: center"><span>$300$</span></td><td style="text-align: center"><span>$\text{s}$</span></td><td style="text-align: center">time-step size</td></tr><tr><td style="text-align: center"><span>$N_x$</span></td><td style="text-align: center"><span>$192$</span></td><td style="text-align: center">dimensionless</td><td style="text-align: center">zonal grid points</td></tr><tr><td style="text-align: center"><span>$N_y$</span></td><td style="text-align: center"><span>$192$</span></td><td style="text-align: center">dimensionless</td><td style="text-align: center">meridional grid points</td></tr><tr><td style="text-align: center"><span>$N_z$</span></td><td style="text-align: center"><span>$32$</span></td><td style="text-align: center">dimensionless</td><td style="text-align: center">vertical levels</td></tr></table><h1 id="Comments-on-Parameter-Choices"><a class="docs-heading-anchor" href="#Comments-on-Parameter-Choices">Comments on Parameter Choices</a><a id="Comments-on-Parameter-Choices-1"></a><a class="docs-heading-anchor-permalink" href="#Comments-on-Parameter-Choices" title="Permalink"></a></h1><ul><li><span>$\Delta b$</span> is the buoyancy jump from the bottom of the domain and the top of the domain. It is chosen so that the buoyancy should remain between <span>$0$</span> and <span>$\Delta b$</span>. The relaxation on the surface is chosen so that the minimum on the surface matches with the minimum on the bottom, and similarly for the maximum. Since the smallest temperature on the surface occurs in the south, this induces isopycnals from the southern surface to the northern bottom.</li><li>The parameters <span>$\lambda^N$</span> and <span>$\lambda^u$</span> were chosen so that there was little overlap in momentum windstress and buoyancy sponge relaxation </li><li>The simulation was insensitive to <span>$\kappa^h$</span>, suggesting that there is a substantial amount of horizontal numerical diffusion</li></ul><h1 id="Initial-Condition"><a class="docs-heading-anchor" href="#Initial-Condition">Initial Condition</a><a id="Initial-Condition-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-Condition" title="Permalink"></a></h1><p>Firstly consider an initial condition for buoyancy of the form</p><p class="math-container">\[\begin{aligned}
b(x, y, z, t= 0 ) &amp;= b_s(y) + b_n(z) - b_n(0)
\end{aligned} \]</p><p>with <span>$b_s(L_y) = b_n(0)$</span> where <span>$b_s(y)$</span> is the surface relaxation profile and <span>$b_n(z)$</span> is the northern wall relaxation. Observe that this choice of initial condition implies</p><p class="math-container">\[\begin{aligned}
b(x, y = L_y, z, t= 0 ) &amp;= b_n(z)  \\
b(x, y , z = 0, t= 0 ) &amp;= b_s(y)  \\
\end{aligned} \]</p><p>In the context of the simulation above this means </p><p class="math-container">\[\begin{aligned}
b(x, y, z, t= 0 ) &amp;=  \underbrace{\Delta b\frac{y}{L_y}}_{\text{surface relaxation}} + \underbrace{\Delta b \frac{\exp(z/h)- \exp(-L_z / h)}{1- \exp(-L_z / h)}}_{\text{northern wall sponge relaxation}} - \underbrace{\Delta b}_{b_s(L_y) = b_n(0)} 
\end{aligned} \]</p><p>From the initial condition for buoyancy we will derive the initial condition for velocity assuming <a href="https://en.wikipedia.org/wiki/Geostrophic_current">Geostrophic Balance</a>,</p><p class="math-container">\[\begin{aligned}
- (f+\beta y) v &amp;= -\frac{1}{\rho^0}\partial_x p  \\
(f+\beta y)u &amp;= - \frac{1}{\rho^0}\partial_y p \\ 
b &amp;=  \frac{1}{\rho^0}\partial_z p 
\end{aligned}\]</p><p>Integrating the last equation yields</p><p class="math-container">\[p(x,y,z) - p(x,y,-L_z) = \rho^0 \int_{-L_z}^z b(y,\zeta) d\zeta,\]</p><p>which can then be differentiated with respect to <span>$x$</span> to give an expression for <span>$v$</span></p><p class="math-container">\[\begin{aligned}
(f+\beta y)v &amp;= -\frac{1}{\rho^0}\partial_x p(x,y,-Lz) .
\end{aligned}\]</p><p>This implies that <span>$v$</span> must be independent of the vertical coordinate <span>$z$</span>. In particular we assign the value <span>$v = 0$</span> at the bottom of the domain since we have a linear drag bottom boundary condition (relaxation to zero). Thus <span>$\partial_x p(x,y,-Lz) = 0 \Rightarrow p(x,y,-Lz) = \rho^0 F(y)$</span> where <span>$F(y)$</span> is some arbitrary function of <span>$y$</span>.</p><p>We now differentiate pressure with respect to <span>$y$</span> to get an expression for the zonal velocity </p><p class="math-container">\[\begin{aligned}
(f+\beta y)u &amp;= - \partial_y \left(\int_{-L_z}^z b(y,\zeta) d\zeta + F(y) \right)
 \\
&amp;= -  \int_{-L_z}^z \partial_y b(y,\zeta) d\zeta - F&#39;(y) 
\end{aligned}\]</p><p>Since <span>$\partial_y b(y,\zeta)$</span> is independent of <span>$\zeta$</span> we can carry out the integral and get</p><p class="math-container">\[\begin{aligned}
(f+\beta y)u &amp;= - (z+L_z)b&#39;_s(y) - F&#39;(y) 
\end{aligned}\]</p><p>We can determine <span>$F&#39;(y) = 0$</span> by evaluating the above expression at <span>$z = -L_z$</span> and using that <span>$u  = 0$</span> at the bottom of the domain. We can then determine that </p><p class="math-container">\[\begin{aligned}
u &amp;= - \frac{z+L_z}{f+\beta y}b&#39;_s(y)
\end{aligned}\]</p><p>The last velocity field <span>$w$</span> can be determined from the continuity equation and the condition that <span>$w=0$</span> at the surface and the bottom to get that the initial condition for <span>$w = 0$</span>.</p><p>Thus in total we have the following concrete initial conditions</p><p class="math-container">\[\begin{aligned}
b^0 &amp;= \Delta b \left(\frac{y}{L_y} +  \frac{\exp(z/h)- \exp(-L_z / h)}{1- \exp(-L_z / h)} - 1\right) \\ 
u^0 &amp;= - \frac{z+L_z}{f+\beta y}\frac{\Delta b}{L_y} \\ 
v^0 &amp;= w^0 = 0
\end{aligned}\]</p><p>We have also starting with the initial condtion</p><p class="math-container">\[\begin{aligned}
b^0 &amp;= \Delta b \left(  \frac{\exp(z/h)- \exp(-L_z / h)}{1- \exp(-L_z / h)} \right) + \mathcal{N}(0,10^{-8}) \\ 
u^0 &amp;= 0\\ 
v^0 &amp;= w^0 = 0
\end{aligned}\]</p><p>where <span>$\mathcal{N}(\mu , \sigma)$</span> is a <a href="https://en.wikipedia.org/wiki/Normal_distribution">Gaussian random variable</a> with mean <span>$\mu$</span> and standard deviation <span>$\sigma$</span>. The noise is added independently to each grid point. The noise was necessary to ensure a quick transition to turbulence.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../channels_home/">« Home</a><a class="docs-footer-nextpage" href="../simulation_abernathy/">Abernathy Setup »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 15 February 2021 22:00">Monday 15 February 2021</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
